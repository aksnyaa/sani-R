---
title: "САНИ_N1_В4_4_ДеркачАксинья"
author: "Деркач Аксинья"
date: "2025-02-08"
output: pdf_document
---
```{r, echo = FALSE, warning = FALSE, message = FALSE}
library(knitr)
library(kableExtra)
library(rio)
library(magrittr)
library(openxlsx)
library(DescTools)
library(EnvStats)
library(outliers)
library(pander)
library(dplyr)
library(psych)
library(ggplot2)
```


## Задание 1
### 1. АНАЛИЗ ТАБЛИЦЫ СОПРЯЖЕННОСТИ 2х2

Вариант 4
*(1) По данным опроса сотрудников некоторой фирмы, представленных в таблице 1, требуется провести анализ взаимосвязи между признаками $X2$ и $X12$ с вероятностью ошибки α = 0,05.*

##### 1.1. Импорт данных

Импортируем данные из таблицы САНИ_ВШЭ_Задачник_часть_1_данные.xlsx в R и присвоим им имя Task1. Проверим
структуру таблицы, вызвав имя таблицы " Task1" в командной строке.

```{r}
Task1 <- import('САНИ_ВШЭ_Задачник_часть_1_данные.xlsx') 
Task1 <- Task1[4:104,]
Task1
```


##### 1.2. Создание таблицы сопряженности

По данным таблицы Task1 постоим таблицу сопряженности с именем table1 для переменных $Х2$ и $Х12$, присвоив им имена “возраст (age)” и “удовлетворенность условиями труда (satisfaction)” соответственно.

```{r}
table1 <- table(Task1$X2, Task1$X12, dnn = c("age", "satisfaction"))
table1
```

Присвоим имена категориям признаков в table1: “моложе 35 (under 35)” и ”старше 35 (over 35)” для признака “возраст”; “удовлетворен условиями труда (satisfied)” и ”не удовлетворен условиями труда (not satisfied)” для признака “удовлетворенность условиями труда”.

```{r}
row.names(table1) <- c("under 35", "over 35")
colnames(table1) <- c("satisfied", "not satisfied")
table1
```

Полученная таблица сопряженности показывает, что исходная совокупность включает 26 людей моложе 35 лет, которые удовлетворены условиями труда, 16 людей младше 35, которые не удовлетворены условиями труда, 52 человек старше 35, которые удовлетворены условиями труда, и 6 человек старше 35, которые не удовлетворены условиями труда.

Построим вероятностную таблицу сопряженности с именем ptable1 для переменных “возраст” и “удовлетворенность условиями труда”.

```{r}
ptable1 <- prop.table(table1)
ptable1
```

##### 1.3. Проверка независимости признаков

###### 1. Критерий согласия (хи-квадрат)

Проверим гипотезу независимости признаков “возраст” и “удовлетворенность условиями труда” на основе критерия согласия и сохраним его результаты в переменную test1.

```{r}
test1 <- chisq.test(Task1$X2, Task1$X12, correct = FALSE)
test1
```

В результате теста нашли значение хи-квадрат_набл = 10.932.
Для вероятности ошибки $\alpha$ = 0.05 и числу степеней свободы $v$ = 1 значение хи-квадрат_крит = 3.8415.
Получается, наблюдаемое значение больше критического, значит, гипотеза Н_о отвергается, признаки зависимы.

Получим таблицу теоретических частот, таблицу остатков и таблицу стандартизированных остатков для признаков “возраст” и “удовлетворенность условиями труда”.

```{r}
test1$expected
```

```{r}
test1$residuals
```

```{r}
test1$stdres
```

###### 2. Критерий согласия с поправкой на непрерывность (Хи-квадрат Йетса)

Проверим гипотезу независимости признаков “возраст” и “удовлетворенность условиями труда” на основе критерия Иетса и сохраним его результаты в переменную test2.

```{r}
test2 <- chisq.test(table1, correct = TRUE)
test2
```

Наблюдаемое значение хи-квадрат = 9.3746, что превышает критическое значение, значит, гипотеза Н_о отвергается, признаки зависимы.

###### 3. Критерий отношения правдоподобий

Проверим гипотезу независимости признаков “возраст” и “удовлетворенность условиями труда” на основе критерия отношения правдоподобии и сохраним его результаты в переменную test3. Получим результаты применения критерия и таблицу теоретических частот.

```{r}
test3 <- GTest(table1)
test3
test3$expected
```

Заметим, что для всех критериев p-value не превосходит 0.05, то есть с вероятностью ошибки 5% гипотеза о независимости признаков отвергается всеми критериями.

###### 4. Точный критерий Фишера

```{r}
test4 <- fisher.test(table1, alternative = "less")
test4
```

Так же p-value не превосходит 0.05, то есть с вероятностью ошибки 5% гипотеза о независимости признаков отвергается.

##### 1.4. Простейшие меры связи

Найдем точечные оценки простеи ших мер связи для переменных “возраст” и “удовлетворенность условиями труда”.

```{r}
YuleQ(table1)
YuleY(table1)
Phi(table1)
TschuprowT(table1)
CramerV(table1)
ContCoef(table1)
```