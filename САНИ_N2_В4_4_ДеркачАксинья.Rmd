---
title: "САНИ_N2_В4_4_ДеркачАксинья"
author: "Деркач Аксинья"
date: "2025-02-20"
output: html_document
---

```{r, echo = FALSE, warning = FALSE, message = FALSE}
library(knitr)
library(kableExtra)
library(magrittr)
library(DescTools)
library(EnvStats)
library(outliers)
library(pander)
library(dplyr)
library(psych)
library(ggplot2)
library(graphics)
```

### 2.1. Импорт данных и создание таблицы сопряженности

```{r}
table3 <- data.frame("B1" = c(58, 62, 29),
"B2" = c(40, 90, 61),
"B3" = c(40, 38, 56),
"B4" = c(34, 27, 45),
"B5" = c(23, 16, 28),
row.names = c("A1", "A2", "A3"), stringsAsFactors = FALSE)
colnames(table3) <- c("B1", "B2", "B3", "B4", "B5")
table3
```
### 2.2. Графическое представление таблицы сопряженности

```{r}
mosaicplot(table3, main = "contingency table",
sub = "way/age",
sort = c(2, 1), off = NULL, dir = c("v", "h"),
color = NULL, shade = TRUE, margin = NULL,
cex.axis = 1.3, las = par("las"), border = NULL,
type = "pearson")
```

Мозаичныи график таблицы table3 показывает, что рассматриваемые признаки (способ поиска и возраст) зависимы, т.к. можно увидеть значительные отклонения в некоторых ячейках (например, B2-A2 выделена синим цветом, B2-A1 и B1-A3 выделены красным цветом). Это указывает на зависимость между признаками (way и age), так как отклонения от ожидаемых значений существенны.

### 2.3. Проверка независимости признаков

1. Критерий согласия

```{r}
test5 <- chisq.test(table3, correct = FALSE)
test5
test5$expected
test5$residuals
```

2. Критерий отношения правдоподобий

```{r}
test6 <- GTest(table3)
test6
```

Оба теста демонстрируют близкие результаты проверки гипотезы. Т.к. для обоих критериев p-value не превосходит 0,1, то с вероятностью ошибки 10% гипотеза о независимости признаков отвергается (признаки зависимы).
Кроме этого, таблица остатков (компонент статистики критерия согласия) количественно подтверждает выводы, полученные на основе мозаичного графика: максимальное отклонение от независимости наблюдаются для ∆n22 = 2.5581667.

### 2.4. Оценка тесноты взаимосвязи – коэффициенты сопряженности

```{r}
ContCoef(table3)
TschuprowT(table3)
CramerV(table3)
```

Коэффициент Пирсона равен 0.24443, что свидетельствует о слабой связи между переменными. Значение коэффициента Чупрова равное 0.15 также говорит о слабой связи между переменными. И значение коэффициента Крамера 0.178 тоже указывает на слабую связь.

γ = 0,899.

```{r}
CramerV(table3, conf.level = 0.899, method = "ncchisq")
CramerV(table3, conf.level = 0.899, method = "ncchisqadj")
CramerV(table3, conf.level = 0.899, method = "fisher")
CramerV(table3, conf.level = 0.899, method = "fisheradj")
```

Т.к. 0 не попадает в интервальные оценки, значит с вероятностью ошибки 10,1% коэффициент Крамера значимо отличается от нуля.

### 2.5. Оценка тесноты взаимосвязи – меры с вероятностной интерпретацией

γ = 0,94.

```{r}
Lambda(table3, direction = "row", conf.level = 0.94)
Lambda(table3, direction = "column", conf.level = 0.94)
Lambda(table3, direction = "symmetric", conf.level = 0.94)
GoodmanKruskalTau(table3, direction = "row", conf.level = 0.94)
GoodmanKruskalTau(table3, direction = "column", conf.level = 0.94)
```

Т.к. 0 не попадает в интервальные оценки, значит с вероятностью ошибки 6% все рассматриваемые меры значимо отличаются от нуля.
При наличии информации о категории респондента по признаку возраст вероятность ошибки предсказания его категории по признаку способ поиска работы может быть снижена на 0.11594 по сравнению с ситуацией, когда эта информация отсутствует.
При наличии информации о категории респондента по признаку способ поиска работы вероятность ошибки предсказания его категории по признаку возраст может быть снижена на 0.03946 по сравнению с ситуацией, когда эта информация отсутствует.
При наличии информации о категории респондента по признаку способ поиска работы или признаку возраст вероятность ошибки предсказания его категории по признаку возраст или признаку способ поиска работы может быть снижена на 0.07586 по сравнению с ситуацией, когда эта информация отсутствует.
В случае пропорционального прогнозирования при наличии информации о категории респондента по признаку возраст вероятность ошибки предсказания его категории по признаку способ поиска работы может быть снижена на 0.032318
по сравнению с ситуацией, когда эта информация отсутствует.
В случае пропорционального прогнозирования при наличии информации о категории респондента по признаку способ поиска работы вероятность ошибки предсказания его категории по признаку возраст может быть снижена на 0.018266
по сравнению с ситуациеи , когда эта информация отсутствует.

### 2.6. Оценка тесноты взаимосвязи – меры, допускающие упорядоченную категоризацию

```{r}
KendallTauA(as.matrix(table3), conf.level = 0.94)
KendallTauB(as.matrix(table3), conf.level = 0.94)
StuartTauC(as.matrix(table3), conf.level = 0.94)
SomersDelta(as.matrix(table3), direction = "row", conf.level = 0.94)
SomersDelta(as.matrix(table3), direction = "column", conf.level = 0.94)
GoodmanKruskalGamma(as.matrix(table3), conf.level = 0.94)
```

Т.к. 0 не попадает в интервальные оценки, значит с вероятностью ошибки 6% все рассматриваемые меры значимо отличаются от нуля.
В соответствии с найденными точечными оценками в рамках рассматриваемой в задаче ранжировки признаков между возрастом и способом поиска работы наблюдается слабая положительная взаимосвязь.